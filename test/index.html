<!DOCTYPE html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if IE 7 ]>    <html class="no-js ie ie7"> <![endif]-->
<!--[if IE 8 ]>    <html class="no-js ie ie8"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
<head>
    <title>Selleckt Test Runner</title>

    <link rel="stylesheet" href="lib/mocha/mocha.css" />

    <!--[if IE 8 ]>
    <script src="../shims/object-create-shim.js"></script>
    <script src="../shims/es5-shim.min.js"></script>
    <![endif]-->

    <script src="lib/jquery-1.10.1.js"></script>
    <script src="lib/underscore.js"></script>
    <script src="lib/mustache.js"></script>

    <script src="lib/mocha/mocha.js"></script>
    <script src="lib/expectations.js"></script>
    <script src="lib/sinon-1.1.0.js"></script>
    <script src="/testem.js"></script>

    <style>
        body{
            background-color:#FFF !important;
            font-size:14px;
            max-width:770px;
            margin-right:260px;
        }
        #testArea{
            position:absolute;
            top:-10000px;
            left:-10000px;
            height:500px;
            width: 770px;
        }
    </style>
</head>
<body>
    <div id="testArea"></div>
    <div id="mocha"></div>

    <script>
    mocha.setup({
        ui: 'bdd'
    });
    </script>

    <script src="browserified_tests.js"></script>

    <script>
    'use strict';
    var runner = mocha.run();
    var failedTests = [];

    function logFailure(test, err){
        var flattenTitles = function(test){
            var titles = [];
            while (test.parent.title){
                titles.push(test.parent.title);
                test = test.parent;
            }
            return titles.reverse();
        };

        failedTests.push({
            name: test.title,
            result: false,
            message: err.message,
            stack: err.stack,
            titles: flattenTitles(test)
        });
    }

    runner.on('end', function(){
        window.mochaResults = runner.stats;
        window.mochaResults.reports = failedTests;
    });

    runner.on('fail', logFailure);
    </script>

    <script>
        if(!window.console){
            window.console = {
                log: function(){},
                warn: function(){},
                error: function(){}
            };
        }
        window.console.trace = window.console.trace || function(){};
        window.console.time = window.console.time || function(){};
        window.console.timeEnd = window.console.timeEnd || function(){};
    </script>

</body>
</html>
